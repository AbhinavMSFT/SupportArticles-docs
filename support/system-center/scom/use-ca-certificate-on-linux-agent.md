---
title: Use CA certificates instead of self-signed SCX certificates
description: Introduces how to use Certificate Authority (CA) certificates instead of self-signed SCX certificates generated by System Center Operations Manager (SCOM).
ms.date: 08/14/2023
ms.reviewer: alexkre, blakedrumm, edpaca, stparker, udmudiar, v-weizhu
ms.topic: how-to
---
# How to use CA certificates instead of self-signed SCX certificates generated by SCOM

This article introduces how to use Certificate Authority (CA) certificates instead of self-signed SCOM Linux agent (SCX) certificates generated by System Center Operations Manager (SCOM).

## Create a CA certificate template

1. Duplicate the computer certificate template on a CA server in your SCOM environment.
2. On the **General** tab, make the following changes:
    - Change the **Template name** to a name easily distinguished for SCOM Linux certificates.
    - Change the value of the **Validity period** field to match your standards.
3. On the **Request Handling** tab, check the **Allow private key to be exported** option.
4. On the **Extensions** tab, remove **Client Authentication** from the **Application Policies** extension. Make sure that the **Application Policies** extension has only **Server Authentication**.
5. On the **Subject Name** tab, select **Supply in the request**.
6. Publish the certificate template.

## Request a CA certificate

You can request a certificate on a Windows machine. Then, export the certificate file to the PKCS #12 (.PFX) format and make sure all the `Subject Name` entries are there.

The certificate must have the following entries in the `Subject Name`. Add them in order:

1. CN=\<ServerNameFQDN>
2. CN=\<ServerName>
3. DC=\<domain component>, for example, `Contoso`
4. DC=\<domain component>, for example, `com`

If you have other domain components, make sure they are in the certificate.

## Use the CA certificate on a Linux agent

On a Windows machine, export the certificate and the private key in the PEM format, and then copy the exported files to a Linux agent:

1. Export the private key by using the following command:

    ```console
    openssl pkcs12 -in <FileName>.pfx -nocerts -out key.pem
    ```

    You'll be prompted for the password of the *\<FileName>.pfx* file and a new password for the new key file.

2. Export the certificate itself by using the following command:

    ```console
    openssl pkcs12 -in <FileName>.pfx -clcerts -nokeys -out omi.pem
    ```

3. Remove the password from the private key by using the following command:

    ```console
    openssl rsa -in key.pem -out omikey.pem 
    ```

    This action is needed since the Linux agent doesn't know the password for the file.

4. Move the certificate file to an appropriate directory by using the following command:

    ```console
    mv omi.pem /etc/opt/omi/ssl/omi.pem
    ```

    This command will ask to override existing certificate files in the directory. `omi.pem` is a pointer to the actual certificate file so there's no need to specify the host file name.

5. Move the key file to an appropriate directory by using the following command:

    ```console
    mv omikey.pem /etc/opt/omi/ssl/omikey.pem
    ```

    This command will also ask to override existing key files in the directory.

6. Restart the agent to use the new certificate by using the following command:

    ```console
    scxadmin -restart
    ```

7. Run the following command on the Linux agent to make sure that the `omiserver` service is running. If the certificate is invalid, it doesn't start.

    ```console
    scxadmin -status
    ```

    You should see the following output if the service is running:

    ```output
    omiagent: x instances running
    ```

The CA certificate must be trusted on both the Linux server and the management servers in the Linux resource pool.
